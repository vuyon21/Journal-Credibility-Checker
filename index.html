<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>UFS Journal Credibility Checker</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
:root{--brand:#0F204B;--accent:#A71930;--removed:#8B8D8E}
*{box-sizing:border-box}
body{font-family:'Roboto',sans-serif;margin:0;background:linear-gradient(135deg,#f5f7fa,#e4e8f0);padding:20px;color:#222}
.container{max-width:960px;margin:0 auto}
header{background:#fff;border-radius:10px;padding:20px;margin-bottom:18px;box-shadow:0 4px 10px rgba(0,0,0,.06);text-align:center}
h1{color:var(--brand);margin:0 0 6px}
.card{background:#fff;padding:22px;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,.05)}
.search-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
input[type="text"]{flex:2;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:15px}
button{padding:11px 14px;border-radius:8px;border:0;cursor:pointer;background:var(--brand);color:#fff;font-weight:600}
.small-btn{padding:9px 12px;background:var(--accent)}
.button-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
pre#journal-report{display:none;white-space:pre-wrap;background:#f8f9fa;padding:18px;border-radius:8px;border:1px solid #e4e8f0;margin-top:14px;max-height:420px;overflow:auto;font-family:monospace}
.removed-list{display:none;margin-top:14px;background:#fff;border-radius:8px;padding:12px;border:1px solid #eee;max-height:320px;overflow:auto;color:var(--removed)}
.status{margin-top:10px;text-align:center;display:none;padding:10px;border-radius:8px}
.status.loading{display:none;background:#fff3cd;color:#856404;border:1px solid #ffeaa7}
.status.error{background:#ffebee;color:#c0392b;border:1px solid #f8d7da}
.recommendation{display:none;margin-top:12px;padding:12px;border-radius:8px;font-weight:600}
.recommendation.recommended{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
.recommendation.verify{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}
.recommendation.not-recommended{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
.footer{margin-top:22px;text-align:center;color:#555}
.autocomplete{position:relative}
#autocomplete-results{position:absolute;left:0;right:0;top:100%;z-index:1000;background:#fff;border:1px solid #ddd;border-top:0;border-radius:0 0 8px 8px;display:none;max-height:200px;overflow:auto}
.autocomplete-item{padding:10px;border-bottom:1px solid #f1f1f1;cursor:pointer}
.autocomplete-item:hover{background:#f0f8ff}
@media (max-width:640px){.search-row{flex-direction:column}}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>UFS Journal Credibility Checker</h1>
    <div style="color:#666">Evaluates journal credibility via accredited lists and real-time lookups from trusted sources</div>
  </header>

  <div class="card">
    <div class="search-row">
      <div class="autocomplete" style="flex:1;position:relative">
        <input id="journal-query" type="text" placeholder="Enter journal title or ISSN (e.g. Nature or 0028-0836)">
        <div id="autocomplete-results"></div>
      </div>
      <button id="check-btn">Check</button>
      <button id="copy-report-btn" class="small-btn">üìã Copy Report</button>
      <button id="download-report-btn" class="small-btn">üíæ Download Report</button>
    </div>

    <div class="button-row">
      <button id="show-removed-btn" style="background:var(--removed)">üóëÔ∏è Show Removed Journals</button>
      <button id="copy-removed-btn" style="background:var(--accent)">üìã Copy Removed Journals</button>
    </div>

    <div class="status loading" id="loading-message">Loading journal data...</div>
    <div class="status error" id="error-message"></div>

    <pre id="journal-report"></pre>
    <div id="recommendation" class="recommendation"></div>

    <div id="removed-journals-list" class="removed-list"></div>

    <div class="footer">Note: Always confirm scope match with your discipline before submission.</div>
  </div>
</div>

<script>
/* ===================== CONFIG ===================== */
const RAW_BASE = 'https://raw.githubusercontent.com/vuyon21/Journal-Credibility-Checker/main/';
const FILENAMES = {
  dhet: 'DHET_2025.txt',
  doaj: 'DOAJ_2025.txt',
  ibss: 'IBSS_2025.txt',
  norwegian: 'NORWEGIAN_2025.txt',
  other: 'OTHER INDEXED JOURNALS_2025.txt',
  scielo: 'SCIELO SA_2025.txt',
  scopus: 'SCOPUS_2025.txt',
  wos: 'WOS_2025.txt',
  removed: 'JOURNALS REMOVED IN PAST YEARS.txt',
  // Transformative agreements will be added like
  // transform_wiley: 'WILEY_2025.csv', etc.
};
const TRANSFORMATIVE_FILES = [
  'WILEY_2025.csv',
  'The Company of Biologists_2025.csv',
  'Taylir & Francis_2025.csv',
  'Springer_2025.csv',
  'ScienceDirect (Elsevier)_2025.csv',
  'SAGE Publishing_2025.csv',
  'Royal Society_2025.csv',
  'Royal Society of Chemistry Platinum_2025.csv',
  'Oxford University Press Journals_2025.csv',
  'IOPscienceExtra_2025.csv',
  'Emerald_2025.csv',
  'Cambridge University Press (CUP)_2025.csv',
  'Bentham Science Publisherst_2025.csv',
  'Association for Computing Machinery (ACM)_2025.csv',
  'American Institute of Physics (AIP)_2025.csv',
  'American Chemicals Society(ACS)_2025.csv'
];

const $ = id => document.getElementById(id);
const journalQuery = $('journal-query');
const checkBtn = $('check-btn');
const autocompleteResults = $('autocomplete-results');
const copyReportBtn = $('copy-report-btn');
const downloadReportBtn = $('download-report-btn');
const showRemovedBtn = $('show-removed-btn');
const copyRemovedBtn = $('copy-removed-btn');
const journalReport = $('journal-report');
const removedJournalsList = $('removed-journals-list');
const loadingMessage = $('loading-message');
const errorMessage = $('error-message');
const recommendation = $('recommendation');

let journalLists = { dhet:[], doaj:[], ibss:[], norwegian:[], other:[], scielo:[], scopus:[], wos:[], removed:[] };
let transformativeList = [];

/* ===================== UTILITIES ===================== */
function showLoading(msg){ loadingMessage.textContent=msg; loadingMessage.style.display='block'; }
function hideLoading(){ loadingMessage.style.display='none'; }
function showError(msg){ errorMessage.textContent=msg; errorMessage.style.display='block'; setTimeout(()=>errorMessage.style.display='none',7000); }
function showSuccessMsg(msg){ console.log('SUCCESS:', msg) }
function normalizeTitle(t){ return (t||'').toLowerCase().replace(/[^a-z0-9]/g,' ').replace(/\s+/g,' ').trim(); }
function isISSN(s){ if(!s) return false; return /\b\d{4}-?\d{3}[\dXx]\b/.test(s); }
function rawUrlFor(fname){ return RAW_BASE + encodeURIComponent(fname); }

/* ===================== LOAD LISTS ===================== */
async function loadAllLists(){
  showLoading('Loading journal lists...');
  for(const [key,fname] of Object.entries(FILENAMES)){
    try{
      const res = await fetch(rawUrlFor(fname));
      const text = await res.text();
      journalLists[key] = text.split(/\r?\n/).map(l=>l.trim()).filter(Boolean).map(l=>({title:l,titleNorm:normalizeTitle(l)}));
    }catch(e){ console.warn('Failed loading',fname,e); journalLists[key]=[]; }
  }
  // load transformative agreements
  transformativeList = [];
  for(const fname of TRANSFORMATIVE_FILES){
    try{
      const res = await fetch(rawUrlFor(fname));
      const text = await res.text();
      const rows = text.split(/\r?\n/).filter(Boolean);
      for(const row of rows){
        const parts = row.split('|').map(p=>p.trim());
        transformativeList.push({
          journal: parts[0],
          issn: parts[1],
          transformative: parts[2],
          notes: parts[3] || '',
          duration: parts[4] || ''
        });
      }
    }catch(e){ console.warn('Failed loading transformative file',fname,e); }
  }
  hideLoading();
}
loadAllLists();

/* ===================== AUTOCOMPLETE ===================== */
journalQuery.addEventListener('input', function(){
  const q = normalizeTitle(this.value||'');
  autocompleteResults.innerHTML=''; autocompleteResults.style.display='none';
  if(q.length<2) return;
  const suggestions=[];
  for(const list of Object.values(journalLists)){
    for(const j of list){
      if(j.titleNorm.includes(q) && !suggestions.includes(j.title)){
        suggestions.push(j.title);
        if(suggestions.length>=8) break;
      }
    }
    if(suggestions.length>=8) break;
  }
  if(suggestions.length){
    for(const t of suggestions){
      const div=document.createElement('div');
      div.className='autocomplete-item'; div.textContent=t;
      div.addEventListener('click',()=>{ journalQuery.value=t; autocompleteResults.style.display='none'; runCheck(); });
      autocompleteResults.appendChild(div);
    }
    autocompleteResults.style.display='block';
  }
});
document.addEventListener('click',e=>{ if(!autocompleteResults.contains(e.target)&&e.target!==journalQuery) autocompleteResults.style.display='none'; });

/* ===================== SEARCH ===================== */
function findOffline(query){
  const qNorm=normalizeTitle(query);
  const issnQuery=isISSN(query)?query.replace('-','').toLowerCase():null;
  let flags={}, sample=null;
  for(const [key,arr] of Object.entries(journalLists)){
    if(key==='removed') continue;
    flags[key]=false;
    for(const j of arr){
      if(issnQuery && normalizeTitle(j.issn||'')===issnQuery){ flags[key]=true; sample=j; break; }
      if(j.titleNorm===qNorm || (j.titleNorm.includes(qNorm)&&qNorm.length>2)){ flags[key]=true; sample=j; break; }
    }
  }
  return {flags,sample};
}
function checkRemovedList(query){ const qNorm=normalizeTitle(query); return journalLists.removed.some(j=>j.titleNorm===qNorm||j.titleNorm.includes(qNorm)); }

/* ===================== BUILD REPORT ===================== */
function buildReportText(query,offlineHit,isRemoved){
  const f=offlineHit.flags||{}, hit=offlineHit.sample||{title:query};
  let recText='‚ö†Ô∏è Note: This journal was not found in any of the key lists. Kindly confirm its credibility with your Faculty Librarian.';
  let recClass='not-recommended';
  if(f.dhet||f.scopus||f.wos){ recText='‚úÖ Recommended: Appears in major credible indexes'; recClass='recommended'; }
  else if(f.doaj||f.ibss||f.scielo){ recText='‚ö†Ô∏è Verify manually: Appears in some indexes but not major ones'; recClass='verify'; }
  if(isRemoved){ recText='‚ùå Not recommended: Appears on removed list'; recClass='not-recommended'; }
  // check transformative
  let trans = transformativeList.filter(t=>normalizeTitle(t.journal)===normalizeTitle(hit.title));
  let transText = trans.length? `Transformative: Yes (${trans.map(t=>t.journal).join(', ')})\n`:'Transformative: No';
  if(trans.length && trans[0].duration){ transText+=`\nDuration: ${trans[0].duration} - ${trans[0].notes}`; }
  // build full text
  const parts=[
`üîç Search: ${query}`,
`üìò Journal: ${hit.title}`,
`üìã ISSN: ${hit.issn||'N/A'}`,
`üè¢ Publisher: ${hit.publisher||'Unknown'}`,
`üí° ${transText}`,
``,
`================== LOCAL ACCREDITATION LISTS ==================`,
`DHET:     ${f.dhet?'‚úÖ Found':'‚ùå Not found'}`,
`DOAJ:     ${f.doaj?'‚úÖ Found':'‚ùå Not found'}`,
`IBSS:     ${f.ibss?'‚úÖ Found':'‚ùå Not found'}`,
`Norwegian:${f.norwegian?'‚úÖ Found':'‚ùå Not found'}`,
`Other:    ${f.other?'‚úÖ Found':'‚ùå Not found'}`,
`SciELO:   ${f.scielo?'‚úÖ Found':'‚ùå Not found'}`,
`Scopus:   ${f.scopus?'‚úÖ Found':'‚ùå Not found'}`,
`WOS:      ${f.wos?'‚úÖ Found':'‚ùå Not found'}`,
``,
`================== RECOMMENDATION ==================`,
`${recText}`
  ];
  return {text:parts.join('\n'),recClass,recText};
}
function showReport(text,recClass,recText){
  journalReport.textContent=text; journalReport.style.display='block';
  recommendation.textContent=recText; recommendation.className='recommendation '+recClass; recommendation.style.display='block';
}

/* ===================== RUN ===================== */
async function runCheck(){
  const query=journalQuery.value.trim();
  if(!query){ showError('Enter a journal title or ISSN'); return; }
  showLoading('Checking journal...');
  const offline=findOffline(query);
  const isRemoved=checkRemovedList(query);
  const rep=buildReportText(query,offline,isRemoved);
  hideLoading(); showReport(rep.text,rep.recClass,rep.recText);
}

/* ===================== BUTTONS ===================== */
checkBtn.addEventListener('click',runCheck);
journalQuery.addEventListener('keypress',e=>{ if(e.key==='Enter') runCheck(); });
copyReportBtn.addEventListener('click',()=>{ navigator.clipboard.writeText(journalReport.textContent).then(()=>showSuccessMsg('Report copied to clipboard')); });
downloadReportBtn.addEventListener('click',()=>{
  const blob = new Blob([journalReport.textContent], {type: "text/plain;charset=utf-8"});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='journal-report.txt'; a.click(); URL.revokeObjectURL(a.href);
});
showRemovedBtn.addEventListener('click',()=>{ removedJournalsList.innerHTML=journalLists.removed.map(j=>j.title).join('\n'); removedJournalsList.style.display='block'; });
copyRemovedBtn.addEventListener('click',()=>{ navigator.clipboard.writeText(journalLists.removed.map(j=>j.title).join('\n')).then(()=>showSuccessMsg('Removed journals copied to clipboard')); });

</script>
</body>
</html>
